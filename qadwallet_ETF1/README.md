Задача "Quick and Dirty Wallet"
====

## Ввведение

Этот репозиторий предназначен для публикации решения задачи учебно-тренировочных сборов для подготовки к финалу профиля "Программная инженерия финансовых технологий" Олимпиады НТИ 2018/19.

Формулировка задачи приведена [здесь](https://hackmd.io/v-jthvtWSzuRnOT6W9OBuA#%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8).

## Подготовка

Прежде чем решать задачу, создайте ветку (_branch_) `develop` в этом репозитории. После этого вы можете склонировать репозиторий к себе на локальную машину и готовить код, решающий задачу.

По факту, вы должны разработать скрипт на языке Python, который должнен называться `qadwallet.py`. Совпадение по имени обязательно!

Перед решением задачи вам необходимо ознакомиться с python библиотекой `web3.py`. Ее документация - в отличном состоянии. Она доступна [здесь](http://web3py.readthedocs.io).

Установите эту библиотеку в свое python окружение. Например, это можно сделать командой:

```shell
$ pip install web3
```

Данная библиотека будет работать с узлом блокчейн сети, основанной на виртуальной машине Ethereum (EVM) посредством JSON-RPC запросов. Какие запросы можно отправлять к узлам блокчейн сети можно прочитать вот [здесь](https://wiki.parity.io/JSONRPC-eth-module).

Обратите внимание на следующие RPC:
  * [eth.blockNumber](https://wiki.parity.io/JSONRPC-eth-module#eth_blocknumber)
  * [eth.getBlockByNumber](https://wiki.parity.io/JSONRPC-eth-module#eth_getblockbynumber)
  * [eth.getTransactionByHash](https://wiki.parity.io/JSONRPC-eth-module#eth_gettransactionbyhash)
  * [eth.getBalance](https://wiki.parity.io/JSONRPC-eth-module#eth_getbalance)
  * [eth.sendRawTransaction](https://wiki.parity.io/JSONRPC-eth-module#eth_sendrawtransaction)
  * [eth.getTransactionReceipt](https://wiki.parity.io/JSONRPC-eth-module#eth_gettransactionreceipt)
  * [eth.getTransactionCount](https://wiki.parity.io/JSONRPC-eth-module#eth_gettransactioncount)

В том или ином виде, данные запросы доступны из библиотеки `web3.py`.

Ваше решение должно работать с тестовой сетью Sokol. Доступ к одному из узлов этой сети доступен, если использовать RPC-URL [https://sokol.poa.network](https://sokol.poa.network).  

Чтобы получить несколько монет для тестирования вашего решения используйте [_faucet_ в сети Sokol](https://faucet-sokol.herokuapp.com/). В нем вы будете должны указать адрес аккаунта, на который необходимо отправить монеты. За раз отправляется `0.5` тестовых монет. Но можно сделать неограниченное количество запросов!

Использование тестовой сети Sokol также позволит вам смотреть, что происходит в блокчейн с вашим аккаунтом, с вашими транзакциями. Для этого перейдите в [эксплорер блоков сети Blockscout](https://blockscout.com/poa/sokol/). В правом верхнем углу есть окошко поиска. Тут можно указывать и адрес, и транзакцию (ее хэш), и номер или хэш блока. Экспериментируйте!

Ваше решение должно будет работать с приватными ключами аккаунтов сети Sokol. Чтобы ознакомиться с принципами написания Ethereum-приложений, использующими приватный ключ, прочитайте раздел ["Working with Local Private Keys"
](https://web3py.readthedocs.io/en/stable/web3.eth.account.html#) из документации `web3.py`.

Одним из быстрых способов получить приватный ключ и адрес - это использовать онлайн ресурс [MyEtherWallet.com](http://myetherwallet.com). Создайте свой кошелек на этом ресурсе и уже на втором шаге создания (после закачивания файла с зашифрованным приватным ключом) в окне браузера отобразится в шестнадцатиричном виде приватный ключ, который вам нужно скопировать себе. Затем этот приватный ключ можно использоваться в этом же сервисе, чтобы узнать соответствующий ему адрес.

### Проверка решения

Обратите внимания на требования к решению, изложенные в [примерах использования в описании задачи](https://hackmd.io/v-jthvtWSzuRnOT6W9OBuA#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F). Именно они и будут проверяться у вашего решения.

Каждый раз, когда вы будете делать `push` в ветку `develop` вашего репозитория у вас будет автоматически проводиться предварительная проверка решения. Результат проверки можно будет видеть в GitLab в разделе `CI/CI -> Pipelines`.

Если проверка прошла успешно, то вы увидете в самом верху списка зеленый значок с надписью `passed`.

Если проверка не прошла, то значок будет красный и надпись будет гласить `failed`. Щелкните по значку (а на новом экране на надпись `test` рядом с красным крестиком), чтобы увидеть на какой именно комманде проверка не прошла. Вам будет показан лог запуска вашего скрипта с различными параметрами. Например,

```
qadwallet.py --tx 0xf026...1bbc
--- ACTUAL RESPONSE:
No such transaction in the local copy of the chain
--- EXPECTED RESPONSE:
No such transaction in the chain
FAILED
TEST 010: Sending transaction when no enough funds.
EXECUTED:
qadwallet.py --key 154A7...536E --to 8b78...23d9A --value 500000000000000000000000
PASSED

Total tests run: 11
Failed tests: 1
ERROR: Job failed: exit code 1
```

**Перед самым первым `push` необходимо пополнить аккаунт 0xB0cA943cF3037DD6C410105fE97c330A1cbe8C70, использующийся для автоматического тестирования вашего решения. Пополните аккаунт на 2.5 монет в [_faucet_ в сети Sokol](https://faucet-sokol.herokuapp.com/)**.

Чтобы ваше решение могло проходить автоматическую проверку в GitLab не удаляйте и не изменяйте файл `.gitlab-ci.yml`.

